

<% form_tag(url_for(:components, :search), method: 'post') do %>
<div class="form-group row">
  <div class="col-sm-2">
    <%= label_tag(:component) %>
  </div>
  <div class="col-sm-6">
    <% opts = ['-', (1..5).to_a].flatten %>
    <%= select_tag_kept(:component_number, options: opts, selected: params[:component_number].to_i) %>
    <span>1: Skating Skills / 2: Transitions / 3: Performance / 4: Composition / 5: Interpretation</span>
  </div>
</div>

<div class="form-group row">
  <div class="col-sm-2">
    <%= label_tag(:skater) %>
  </div>
  <div class="col-sm-10">
    <% skaters = ['-', Skater.select(:name).to_a.map(&:name)].flatten %>
    <%= select_tag_kept(:skater_name, options: skaters, selected: params[:skater_name]) %>
  </div>
</div>

<div class="form-group row">
  <div class="col-sm-2">
    <%= label_tag("Category") %>
  </div>
  <div class="col-sm-10">
    <%= select_tag_kept(:category, options: ['-', 'MEN', 'LADIES'], selected: params[:category]) %>
  </div>
</div>

<div class="form-group row">
  <div class="col-sm-2">
    <%= label_tag("Segment") %>
  </div>
  <div class="col-sm-10">
    <%= select_tag_kept(:segment, options: ['-', 'SHORT PROGRAM', 'FREE SKATING'], selected: params[:segment]) %>
  </div>
</div>

<div class="form-group row">
  <div class="col-sm-2">
    <%= label_tag("Nation") %>
  </div>
  <div class="col-sm-10">
    <% nations = ['-', Score.select(:nation).distinct.to_a.map {|n| n.nation}].flatten %>
    <%= select_tag_kept(:nation, options: nations, selected: params[:nation]) %>
  </div>
</div>

<div class="form-group row">
  <div class="col-sm-2">
    <%= label_tag(:competition) %>
  </div>
  <div class="col-sm-10">
    <% competitions = ['-', Score.select(:competition_name).distinct.to_a.map {|c| c.competition_name}].flatten %>
    <%= select_tag(:competition, options: competitions, selected: params[:competition] || '-') %>
  </div>
</div>


<div class="form-group row">
  <div class="col-sm-2">
    <%= label_tag("output format") %>
  </div>
  <div class="col-sm-10">
    <%= select_tag(:format, options: ['html', 'json', 'csv']) %>
  </div>
</div>



<div class="form-group row">
  <div class="col-sm-2">
  </div>
  <div class="col-sm-10">
    <%= submit_tag("search", :class=>"btn btn-primary", :type=>"submit") %>
  </div>
</div>


<% end %>


<table class="table table-striped table-hover table-condensed">
  <tr>
    <th>Score ID</th>
    <th>Skater</th>
    <th>Competition</th>
    <th>Category</th>
    <th>Segment</th>
    <th>Number</th>
    <th>Component</th>
    <th>Factor</th>
    <th>Judges</th>
    <th>Score</th>
  </tr>
</td>
  <% components.each do |component| %>
  <% score = component.score %>
  <tr>
    <td><%= link_to(score.id, url_for(:scores, :id, id: score.id)) %></td>
    <td><%= score.skater.name %></td>
    <td><%= score.competition_name %></td>
    <td><%= score.category %></td>
    <td><%= score.segment %></td>
    <td><%= component.number %></td>
    <td><%= component.component %></td>
    <td><%= component.factor %></td>
    <td><%= component.judges %></td>
    <td><%= component.value %></td>
  </tr>
  <% end %>
</table>
